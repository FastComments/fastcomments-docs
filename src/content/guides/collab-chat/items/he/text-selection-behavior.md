### How Text Selection Works

כאשר משתמשים בוחרים טקסט בתוך המכולה של Collab Chat, הווידג'ט קולט את הבחירה ומאפשר להם לפתוח דיון. הבחירה יכולה להיות קטנה ככל שמילה בודדת או גדולה עד מספר פסקאות החוצות אלמנטים שונים.

### Selection Delay

במכשירי שולחן עבודה קיימת השהייה של 3.5 שניות בין הרגע שבו משתמש בוחר טקסט לבין הופעת ההנחיה לפתיחת הדיון. זה מונע מהממשק להבהב כאשר משתמשים רק מסמלים טקסט להעתקה או לקריאה. במכשירים ניידים ההנחיה מופיעה מיד מכיוון שבחירת טקסט במסכי מגע היא בדרך כלל מכוונת יותר.

### Unique Conversation IDs

לכל שיחה מוקצה `urlId` ייחודי שמשלב את כתובת הדף, נתיב אלמנט ה-DOM, וטווח הטקסט הסריאליזованный. זה מבטיח שלכל בחירת טקסט נוצר דיון נפרד שאפשר למצוא שוב מאוחר יותר.

אם תספק `urlId` מותאם בקונפיגורציה שלך, הוא ישולב עם נתיב האלמנט וטווח הטקסט ליצירת המזהה הסופי.

### Visual Highlights

כאשר יש דיון עבור בחירת טקסט מסוימת, הטקסט מקבל הדגשה ויזואלית. ההדגשה ממומשת באמצעות צבעי רקע ומופיעה בעת ריחוף או כאשר חלון הצ'אט המשויך פתוח.

מערכת ההדגשה עובדת על ידי עטיפת הטקסט הנבחר ברכיב מיוחד שניתן לעיצוב. גישה זו מוודאת שההדגשות נשארות מדויקות גם כאשר מבנה ה-HTML הבסיסי מורכב.

### Chat Window Positioning

כאשר משתמש לוחץ על הדגשה או יוצר תיאור חדש, חלון צ'אט מופיע בסמוך לטקסט הנבחר. הווידג'ט מחשב אוטומטית את המיקום הטוב ביותר לחלון זה בהתבסס על מרחב התצוגה הזמין.

מנגנון המיקום משתמש במחלקות CSS כמו `to-right`, `to-left`, `to-top`, ו-`to-bottom` כדי להצביע לאיזו כיוון חלון הצ'אט צריך להתרחב מההדגשה. במכשירי מובייל (מסכים פחות מ-768px ברוחב), חלון הצ'אט תמיד מופיע במסך מלא לשימוש נוח יותר.

### Chat Window Dimensions

חלונות הצ'אט ברוחב של 410px בשולחן העבודה עם ריווח של 20px וחץ ויזואלי של 16px שמצביע לטקסט המודגש. מימדים אלה קבועים כדי להבטיח התנהלות עקבית, אך ניתן להתאים את המראה באמצעות CSS.

### Cross-Element Selections

משתמשים יכולים לבחור טקסט החוצה אלמנטים HTML מרובים, כמו הדגשה מהאמצע של פסקה ועד תחילתה של פסקה אחרת. מערכת סריאליזציית הטווח מטפלת בזה נכון ותדגיש את כל הטקסט הנבחר אפילו מעבר לגבולות אלמנטים.

### Browser Compatibility

מערכת בחירת הטקסט משתמשת ב-API הסטנדרטי `window.getSelection()` הנתמך בכל הדפדפנים המודרניים. לגרסאות ישנות של Internet Explorer יש fallback ל-`document.selection` לתאימות.

### Selection Persistence

לאחר שנוצר דיון עבור בחירת טקסט, ההערה נשמרת גם אם הדף נטען מחדש. הטווח הסריאליזованный ונתיב ה-DOM מאפשרים לווידג'ט לשחזר את ההדגשות באותו מיקום בדיוק כאשר משתמשים חוזרים לדף.

זה עובד באופן אמין כל עוד תוכן הדף שלך נשאר יציב. אם תשנה את תוכן הטקסט או תבנה מחדש את ה-HTML שלך, ההערות הקיימות עשויות לא להתיישב יותר כהלכה עם הטקסט. מסיבה זו עדיף להימנע משינויים משמעותיים בתוכן בעמודים עם הערות פעילות, או לשקול להעביר את ההערות כאשר שינויים בתוכן הכרחיים.