FastComments надає просте у використанні рішення SSO. Оновлення інформації користувача через інтеграцію на основі HMAC так само просте, як завантаження сторінки користувачем з оновленим payload.

Однак може бути бажаним керувати користувачем поза цим потоком, щоб підвищити узгодженість вашого застосунку.

SSO User API надає спосіб CRUD-операцій для об'єктів, які ми називаємо SSOUsers. Ці об'єкти відрізняються від звичайних Users і зберігаються окремо для типобезпеки.

Структура об'єкта SSOUser виглядає так:

[inline-code-attrs-start title = 'Структура SSOUser'; type = 'typescript'; isFunctional = false; inline-code-attrs-end]
[inline-code-start]
interface SSOUser {
    id: string
    username: string
    email?: string
    websiteUrl?: string
    signUpDate: number
    createdFromUrlId?: string
    loginCount?: number
    avatarSrc?: string
    optedInNotifications?: boolean
    optedInSubscriptionNotifications?: boolean
    displayLabel?: string
    displayName?: string
    isAccountOwner?: boolean // Разрешение адміністратора - SSO users з цим прапором враховуються як SSO Admins (окремо від звичайних SSO users)
    isAdminAdmin?: boolean // Разрешение адміністратора - SSO users з цим прапором враховуються як SSO Admins (окремо від звичайних SSO users)
    isCommentModeratorAdmin?: boolean // Разрешение модератора - SSO users з цим прапором враховуються як SSO Moderators (окремо від звичайних SSO users)
    /** Якщо null, Контроль доступу не буде застосований до користувача. Якщо порожній список, цей користувач не зможе бачити жодні сторінки або згадувати інших користувачів через @mention. **/
    groupIds?: string[] | null
    createdFromSimpleSSO?: boolean
    /** Не дозволяйте іншим користувачам бачити активність цього користувача, включаючи коментарі, на його профілі. За замовчуванням true, щоб забезпечити безпечні профілі за замовчуванням. **/
    isProfileActivityPrivate?: boolean
    /** Не дозволяйте іншим користувачам залишати коментарі в профілі користувача або бачити існуючі коментарі профілю. За замовчуванням false. **/
    isProfileCommentsPrivate?: boolean
    /** Не дозволяйте іншим користувачам надсилати цьому користувачу приватні повідомлення. За замовчуванням false. **/
    isProfileDMDisabled?: boolean
    karma?: number
    /** Необов'язкова конфігурація для бейджів користувача. **/
    badgeConfig?: {
        /** Масив ID бейджів, які призначаються користувачу. Обмежено 30 бейджами. Порядок зберігається. **/
        badgeIds: string[]
        /** Якщо true, замінює всі існуючі відображувані бейджі на вказані. Якщо false, додає до існуючих бейджів. **/
        override?: boolean
        /** Якщо true, оновлює властивості відображення бейджів з конфігурації tenant. **/
        update?: boolean
    }
}
[inline-code-end]

### Білінг для SSO користувачів

SSO users оплачуються по-різному в залежності від їхніх прапорів дозволів:

- **Регулярні SSO users**: Користувачі без прав адміністратора або модератора оплачуються як регулярні SSO users
- **SSO Admins**: Користувачі з прапорами `isAccountOwner` або `isAdminAdmin` оплачуються окремо як SSO Admins (така ж ставка, як для звичайних адміністраторів tenant)
- **SSO Moderators**: Користувачі з прапором `isCommentModeratorAdmin` оплачуються окремо як SSO Moderators (така ж ставка, як для звичайних модераторів)

**Важливо**: Щоб запобігти подвійній оплаті, система автоматично дедуплікує SSO users щодо звичайних tenant users і moderators за адресою електронної пошти. Якщо SSO user має той самий адресу електронної пошти, що й звичайний tenant user або moderator, він не буде оплачений двічі.

### Контроль доступу

Користувачів можна розбити на групи. Саме для цього призначено поле `groupIds`, і воно є необов'язковим.

### @Упоминания

За замовчуванням `@mentions` будуть використовувати `username` для пошуку інших sso users, коли вводиться символ `@`. Якщо використовується `displayName`, то результати, що відповідають `username`, будуть ігноруватися, коли знайдено відповідність для `displayName`, і результати пошуку @mention будуть використовувати `displayName`.

### Підписки

У FastComments користувачі можуть підписатися на сторінку, натиснувши іконку дзвінка у віджеті коментарів і вибравши Subscribe.

Для звичайного користувача ми відправляємо їм повідомлення електронною поштою відповідно до їхніх налаштувань повідомлень.

У випадку SSO Users ми розділяємо це для зворотної сумісності. Додаткові електронні листи з повідомленнями про підписки будуть надсилатися лише якщо ви встановите `optedInSubscriptionNotifications` в `true`.

### Значки

Ви можете призначати значки SSO users за допомогою властивості `badgeConfig`. Значки — це візуальні індикатори, які відображаються поруч із ім'ям користувача в коментарях.

- `badgeIds` - Масив ID бейджів, які призначаються користувачу. Ці ID повинні бути дійсними ID бейджів, створених у вашому акаунті FastComments. Обмежено 30 бейджами.
- `override` - Якщо true, всі існуючі бейджі, що відображаються в коментарях, будуть замінені на вказані. Якщо false або опущено, вказані бейджі будуть додані до будь-яких існуючих бейджів.
- `update` - Якщо true, властивості відображення бейджів будуть оновлюватися з конфігурації tenant щоразу, коли користувач входить в систему.

---