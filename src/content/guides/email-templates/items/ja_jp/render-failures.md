---
メールテンプレートは変数やロジックをサポートしているため、レンダリングに失敗する、あるいは時々レンダリングに失敗するテンプレートを作成してしまう可能性があります。

これは診断やデバッグが非常に厄介になることがあり、特に断続的に発生する問題や、データの特定の状態のときにのみ発生する場合はそうです。

これを助けるために、FastComments のメールテンプレートにはいくつかの機能があります：

1. テンプレートのプレビューに失敗した場合、そのテンプレートは保存できません。エラーメッセージが表示されます。
2. テンプレートのレンダリング失敗は追跡され、管理画面で報告されます。

2つ目の箇条書きは、本番環境で発生するレンダリング失敗を指しています。つまり、プレビュー時は問題なく表示されるテンプレートを作成したが、後で何らかの理由で失敗することがあります。例えば、テンプレートに次のような記述があるとします：

    <% if (comment.commenterEmail.includes('test') { %>

匿名コメントが有効な場合、メールアドレスが常に存在するわけではないため、これは時々失敗することがあります。では、それをどうやって見つけるのでしょうか？

答えは、エラーは2か所に表示されるということです。まず、テンプレート一覧自体に各テンプレートのレンダーエラー数が表示されます。

そして、テンプレートを表示すると、エラーごとにそのテンプレートがレンダリングに失敗した回数のカウントが確認できます。

各エラーとそのカウントの横にはリセットボタンがあり、問題を解決した後にカウンターをリセットできます。

---