### Required Components

За On-Prem, FastComments се састоји само од апликационог сервера и базе података. Поједноставили смо размештање тако да апликација може обслуживати сав саобраћај директно без додавања других компоненти.

Апликациони сервер је обезбеђен у Docker имиджу и може се размештати помоћу било ког решења за управљање контејнерима.

База података, MongoDB, може се покретати самостално или бити хостована код другог провајдера као што су AWS DocumentDB или MongoDB Atlas.

FastComments је тренутно тестирано са MongoDB 7, међутим циљ нам је да буде компатибилно са DocumentDB како бисмо олакшали размештање.

### Instance Sizes

Установићете да је FastComments прилично добро оптимизован и да за саму апликацију не захтева велике машине да би одржао ниске P99 вредности.

Сви батч и cron задаци користе стриминг да би ограничили укупну употребу меморије.

Доње табеле за апликациони сервер и базу података могу помоћи при одређивању величине.

### Application Server Instances


| Конкурентни корисници | Укупни CPU-ови у кластеру | Укупна меморија кластера |
|-----------------------|---------------------------|--------------------------|
| 100                   | 1                         | 256mb                   |
| 1K                    | 2                         | 512mb                   |
| 10K                   | 8                         | 1gb                     |
| 100K                  | 32                        | 8gb                     |
| 1M                    | 64                        | 64gb                    |

На пример, једно језгро које служи око 100 нитова коментара у секунди обично никада не користи више од 250mb RSS.

### Database Server Instances

Размер базе података зависи од величине радног сета (working set), што је количина података којој приступате у одређеном тренутку, као и од конкуретних захтева.

FastComments је прилично благ према Mongo-у, јер за „вреле“ упите користи index hints, streaming cursors, и има ограничења у погледу конкурентности у различитим областима како би спречио преоптерећење низводних система.

Следеће представља опште смернице за величину инстанци базе података. **Имајте у виду да је ово __по инстанци__, а не укупни ресурси у кластеру**.

| Конкурентни корисници | Сачувани коментари | CPU-ови по инстанци | Меморија по инстанци |
|-----------------------|--------------------|---------------------|----------------------|
| 100                   | 1k                 | 1                   | 256mb                |
| 1K                    | 5k                 | 2                   | 512mb                |
| 10K                   | 100k               | 8                   | 2gb                  |
| 100K                  | 500k               | 16                  | 8gb                  |
| 1M                    | 5M                 | 32                  | 32gb                 |

Горње табеле су конзервативне процене. Можда ћете утврдити да се стварни захтеви разликују у зависности од ваше конкретне конфигурације (великина страница, запремина коментара итд.).