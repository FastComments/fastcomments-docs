### Потребне компоненте

За On-Prem, FastComments се састоји само од апликационог сервера и базе података. Поједноставили смо деплој тако да апликација може да обрађује сав саобраћај директно без додавања других компоненти.

Апликациони сервер је обезбеђен у Docker слици и може се деплојовати помоћу било ког решења за управљање контејнерима.

База података, MongoDB, може да се покреће самостално или да буде хостирана код другог провајдера као што су AWS DocumentDB или MongoDB Atlas.

FastComments је тренутно тестиран са MongoDB 7, међутим циљамо компатибилност са DocumentDB ради олакшања распоређивања.

### Величине инстанци

Увидећете да је FastComments прилично добро оптимизован и да не захтева велике машине за саму апликацију да би одржао ниске P99 вредности.

Сви batch и cron задаци користе streaming како би ограничили укупну употребу меморије.

Доње табеле за апликациони сервер и базу података могу помоћи при одређивању величине.

### Инстанце апликационог сервера


| Истовремени корисници | Укупни Cluster CPUs | Укупна Cluster меморија |
|-----------------------|---------------------|-------------------------|
| 100                   | 1                   | 256mb                   |
| 1K                    | 2                   | 512mb                   |
| 10K                   | 8                   | 1gb                     |
| 100K                  | 32                  | 8gb                     |
| 1M                    | 64                  | 64gb                    |

На пример, једно језгро које служи око 100 тема коментара у секунди обично никада не користи више од 250mb RSS.

### Инстанце сервера базе података

Одређивање величине базе података зависи од величине радног сета, што је количина података којима приступате у датом тренутку, као и од истовремених захтева.

FastComments је прилично пријатељски према Mongo-у, јер за вруће упите користи index hints, streaming cursors, и има ограничења паралелности у разним областима како би спречио преоптерећење downstream система.

Доње је општа смерница за величине инстанци базе података. **Имајте у виду да је ово __по инстанци__, а не укупни ресурси у кластеру**.

| Истовремени корисници | Сачувани коментари | CPU-ова по инстанци | Меморија по инстанци |
|-----------------------|--------------------|---------------------|----------------------|
| 100                   | 1k                 | 1                   | 256mb                |
| 1K                    | 5k                 | 2                   | 512mb                |
| 10K                   | 100k               | 8                   | 2gb                  |
| 100K                  | 500k               | 16                  | 8gb                  |
| 1M                    | 5M                 | 32                  | 32gb                 |

Горње табеле су конзервативне процене. Може се десити да се стварни захтеви разликују у зависности од ваше специфичне конфигурације (величине страница, обима коментара итд).

---