### Ενημερώσεις σε πραγματικό χρόνο

Image Chat χρησιμοποιεί συνδέσεις WebSocket για να συγχρονίζει όλες τις συζητήσεις σε πραγματικό χρόνο μεταξύ όλων των συνδεδεμένων χρηστών. Όταν κάποιος δημιουργεί ένα νέο σημείο επισήμανσης, προσθέτει ένα σχόλιο ή διαγράφει μια συζήτηση, όλοι οι άλλοι χρήστες που βλέπουν την ίδια εικόνα βλέπουν την ενημέρωση αμέσως χωρίς να ανανεώσουν τη σελίδα.

### Πώς λειτουργεί ο συγχρονισμός WebSocket

Όταν αρχικοποιείτε το Image Chat, το widget καθιερώνει μια σύνδεση WebSocket προς τους servers του FastComments. Αυτή η σύνδεση παραμένει ανοιχτή για τη διάρκεια της συνεδρίας του χρήστη και ακούει για ενημερώσεις που σχετίζονται με την τρέχουσα εικόνα.

Το σύστημα WebSocket χρησιμοποιεί τρεις τύπους μηνυμάτων μετάδοσης για το Image Chat. Το `new-image-chat` event ενεργοποιείται όταν κάποιος δημιουργεί ένα νέο marker στην εικόνα. Το `image-chat-updated` event ενεργοποιείται όταν κάποιος ενημερώνει μια υπάρχουσα συνομιλία. Το `deleted-image-chat` event ενεργοποιείται όταν κάποιος διαγράφει ένα marker.

### Σύστημα Broadcast ID

Για να αποτραπούν φαινόμενα ηχούς όπου οι χρήστες βλέπουν τις δικές τους ενέργειες να εκπέμπονται πίσω σε αυτούς, κάθε ενημέρωση περιλαμβάνει ένα μοναδικό `broadcastId`. Όταν ένας χρήστης δημιουργεί ή ενημερώνει ένα marker, ο client του δημιουργεί ένα UUID για αυτήν την ενέργεια. Όταν το WebSocket μεταδίδει ξανά την ενημέρωση σε όλους τους clients, ο αρχικός client αγνοεί την ενημέρωση επειδή ταιριάζει με το δικό του `broadcastId`.

Αυτό εξασφαλίζει ομαλή αλληλεπίδραση όπου οι χρήστες βλέπουν τις αλλαγές τους άμεσα στο UI χωρίς να περιμένουν τον γύρο-ταξίδι μέσω του server, ενώ ταυτόχρονα διασφαλίζει ότι όλοι οι άλλοι χρήστες λαμβάνουν την ενημέρωση.

### Ανθεκτικότητα σύνδεσης

Εάν η σύνδεση WebSocket διακοπεί λόγω προβλημάτων δικτύου ή συντήρησης του server, το widget προσπαθεί αυτόματα να επανασυνδεθεί. Κατά την περίοδο επανασύνδεσης, οι χρήστες μπορούν ακόμα να αλληλεπιδρούν με υπάρχοντα markers, αλλά δεν θα βλέπουν ενημερώσεις σε πραγματικό χρόνο από άλλους χρήστες μέχρι να αποκατασταθεί η σύνδεση.

Μόλις επανασυνδεθεί, το widget επανασυγχρονίζεται για να εξασφαλιστεί ότι δεν χάθηκαν ενημερώσεις. Αυτό συμβαίνει διαφανώς χωρίς να απαιτείται παρέμβαση του χρήστη.

### Θέματα εύρους ζώνης

Τα μηνύματα WebSocket είναι ελαφριά και περιέχουν μόνο τις απαραίτητες πληροφορίες για τον συγχρονισμό της κατάστασης. Η δημιουργία ενός νέου marker συνήθως χρησιμοποιεί λιγότερο από 1KB εύρους ζώνης. Το σύστημα περιλαμβάνει επίσης ευφυή ομαδοποίηση για μείωση της συχνότητας μηνυμάτων κατά περιόδους υψηλής δραστηριότητας.

Τα μετρικά χρήσης σας στον πίνακα ελέγχου του FastComments παρακολουθούν τα `pubSubMessageCount` και `pubSubBandwidth` ώστε να μπορείτε να παρακολουθείτε τη δραστηριότητα συγχρονισμού σε πραγματικό χρόνο στις τοποθεσίες σας.

### Συγχρονισμός μεταξύ καρτελών

Εάν ένας χρήστης έχει την ίδια σελίδα ανοιχτή σε πολλαπλές καρτέλες του προγράμματος περιήγησης, οι ενημερώσεις σε μια καρτέλα εμφανίζονται αμέσως στις άλλες καρτέλες. Αυτό λειτουργεί μέσω του ίδιου μηχανισμού συγχρονισμού WebSocket και δεν απαιτεί επιπλέον ρυθμίσεις.

Οι χρήστες μπορούν να έχουν την ιστοσελίδα σας ανοιχτή σε πολλές συσκευές ταυτόχρονα και όλες θα παραμένουν συγχρονισμένες. Ένα marker που δημιουργείται σε ένα επιτραπέζιο υπολογιστή εμφανίζεται αμέσως στο tablet του χρήστη αν και οι δύο συσκευές βλέπουν την ίδια εικόνα.

### Ασφάλεια

Τα μηνύματα WebSocket μεταδίδονται μέσω ασφαλών συνδέσεων (WSS) και περιλαμβάνουν επικύρωση tenant για να διασφαλιστεί ότι οι χρήστες λαμβάνουν μόνο ενημερώσεις για συνομιλίες που έχουν εξουσιοδότηση να δουν. Ο server επικυρώνει όλες τις ενέργειες πριν τις μεταδώσει για να αποτρέψει μη εξουσιοδοτημένη πρόσβαση ή χειραγώγηση.

### Συμπεριφορά εκτός σύνδεσης

Όταν οι χρήστες είναι εντελώς εκτός σύνδεσης, μπορούν ακόμα να προβάλλουν υπάρχοντα markers αλλά δεν μπορούν να δημιουργήσουν νέα ή να δουν ενημερώσεις από άλλους. Το widget εντοπίζει την κατάσταση εκτός σύνδεσης και εμφανίζει κατάλληλα μηνύματα.

Εάν ένας χρήστης προσπαθήσει να δημιουργήσει ένα marker ενώ είναι εκτός σύνδεσης και μετά επανέλθει σε σύνδεση, η ενέργεια θα αποτύχει αντί να τεθεί σε ουρά, εξασφαλίζοντας συνέπεια στα δεδομένα. Οι χρήστες θα πρέπει να επαναλάβουν την ενέργεια όταν αποκατασταθεί η σύνδεσή τους.

### Επίδραση στην απόδοση

Η σύνδεση WebSocket έχει ελάχιστη επίδραση στην απόδοση. Η σύνδεση παραμένει αδρανής όταν δεν συμβαίνουν ενημερώσεις και επεξεργάζεται μηνύματα μόνο όταν υπάρχει δραστηριότητα. Σε μια τυπική εικόνα με μέτρια δραστηριότητα markers, το WebSocket χρησιμοποιεί λιγότερη CPU από ό,τι η απόδοση της ίδιας της εικόνας.

Για σελίδες με εκατοντάδες ταυτόχρονους χρήστες και υψηλή δραστηριότητα δημιουργίας markers, το σύστημα κλιμακώνεται οριζόντια για να διατηρήσει την απόδοση χωρίς να επηρεάσει τις συνδέσεις των μεμονωμένων πελατών.

### Σενάρια συνεργασίας

Ο συγχρονισμός σε πραγματικό χρόνο καθιστά το Image Chat ιδιαίτερα ισχυρό για συνεργατικές ροές εργασίας. Ομάδες σχεδίασης μπορούν να εξετάσουν mockups μαζί, με όλους να βλέπουν τις τοποθετήσεις των markers σε πραγματικό χρόνο. Ομάδες υποστήριξης πελατών μπορούν να σχολιάζουν από κοινού στιγμιότυπα οθόνης για να εντοπίσουν προβλήματα. Εκπαιδευτικές ομάδες μπορούν να συζητούν διαγράμματα με όλους τους συμμετέχοντες να βλέπουν τα markers των άλλων καθώς δημιουργούνται.

Η άμεση ανατροφοδότηση δημιουργεί μια πιο ελκυστική και παραγωγική εμπειρία συνεργασίας σε σύγκριση με τα παραδοσιακά συστήματα σχολιασμού όπου οι χρήστες πρέπει να ανανεώσουν για να δουν ενημερώσεις.