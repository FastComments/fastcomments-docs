### Процентное позиционирование

Image Chat использует координаты на основе процентов вместо пиксельных координат для расположения маркеров чата на изображениях. Когда пользователь кликает по изображению, виджет преобразует пиксельные координаты клика в проценты от ширины и высоты изображения. Такой подход гарантирует, что маркеры остаются в правильном месте независимо от того, как отображается изображение.

Например, если пользователь кликнул в 250 пикселях от левого края изображения шириной 1000px, виджет сохраняет это как 25% от левого края. Когда другой пользователь просматривает то же изображение шириной 500px на мобильном устройстве, маркер появляется в 125 пикселях от левого края, что по-прежнему составляет 25% от ширины.

### Преимущества для адаптивной верстки

Эта процентная система позволяет Image Chat корректно работать на всех размерах устройств и ориентациях. Ваши изображения могут отображаться в разных размерах в зависимости от ширины экрана, CSS-правил или ограничений контейнера, но маркеры всегда будут правильно совпадать с задуманными местами.

Пользователи на настольных компьютерах с большими мониторами видят маркеры в тех же относительных позициях, что и пользователи на смартфонах с маленькими экранами. Маркеры масштабируются пропорционально самому изображению.

### Масштабирование изображения и соотношение сторон

Пока ваше изображение сохраняет соотношение сторон при изменении размера (что является поведением браузера по умолчанию), процентные маркеры будут оставаться идеально выровненными. Виджет предполагает, что изображения масштабируются пропорционально и рассчитывает позиции на этом основании.

Если вы применяете CSS, которое искажает соотношение сторон изображения (например, используя `object-fit: cover` с заданными размерами), позиции маркеров могут не совпадать корректно. Для наилучших результатов позволяйте изображениям масштабироваться естественным образом или используйте `object-fit: contain`, чтобы сохранять соотношение сторон.

### Размер чат-квадрата

Визуальный размер маркеров чата также основан на процентах. Опция конфигурации `chatSquarePercentage` по умолчанию равна 5%, что означает, что каждый квадрат составляет 5% от ширины изображения. Это обеспечивает согласованный визуальный вес на изображениях разного размера.

На изображении шириной 1000px с настройкой по умолчанию 5% маркеры имеют размеры 50px. На изображении шириной 500px те же маркеры имеют размеры 25px. Они остаются пропорциональными размеру изображения.

### Поведение на мобильных устройствах

На экранах шириной меньше 768px Image Chat переключается на оптимизированную для мобильных устройств компоновку. Окна чата открываются во весь экран вместо плавающего окна рядом с маркером. Это обеспечивает лучшую удобочитаемость на маленьких экранах, где плавающие окна скрывали бы слишком большую часть изображения.

Сами маркеры остаются видимыми и кликабельными в своих процентных позициях. Пользователи по‑прежнему видят, где расположены все обсуждения, и могут нажимать на маркеры, чтобы открыть полноэкранный интерфейс чата.

### Динамическая загрузка изображений

Процентная система работает корректно даже когда изображения загружаются асинхронно или меняют размер после загрузки страницы. Виджет отслеживает элемент изображения и пересчитывает позиции маркеров всякий раз, когда изменяются размеры изображения.

Если вы используете ленивую загрузку изображений или реализуете адаптивные изображения с разными размерами для разных точек преломления, маркеры автоматически подстраиваются при изменении размера изображения.

### Согласованность между устройствами

Поскольку координаты сохраняются в базе данных в процентах, обсуждение, созданное на настольном компьютере, появляется в точно том же относительном месте при просмотре на планшете или телефоне. Пользователи могут совместно работать на разных устройствах без несоответствий в позиционировании.

Это работает в обоих направлениях. Обсуждение, созданное путём касания определённого места на мобильном устройстве, появляется в той же относительной позиции при просмотре на большом настольном мониторе.

### Учет области просмотра

Виджет рассчитывает проценты относительно самого элемента изображения, а не относительно viewport. Это означает, что прокрутка страницы или изменение размера окна браузера не влияют на позиции маркеров. Маркеры остаются привязанными к своим местам на изображении независимо от изменений области просмотра.

### Защита контента на будущее

Процентный подход делает ваши обсуждения изображений устойчивыми к изменениям в верстке, дизайне или экосистеме устройств. По мере появления новых размеров экранов и устройств существующие обсуждения будут продолжать отображаться корректно без необходимости обновлений или миграций.