Когато SAML е активиран в FastComments, системата автоматично генерира информация за доставчика на услуги (SP), която трябва да конфигурирате във вашия доставчик на идентичности.

### Достъп до информацията за доставчика на услуги

Информацията за SP се показва на страницата с конфигурация на SAML след активиране на SAML автентикацията. Тази информация включва всички детайли, от които вашият доставчик на идентичности се нуждае, за да установи доверителни отношения с SAML.

### Крайни точки на доставчика на услуги

#### SP Entity ID / Audience
**Цел**: Уникално идентифицира вашия FastComments екземпляр като доставчик на услуги  
**Формат**: `https://fastcomments.com/saml/{your-tenant-id}`  
**Използване**: Конфигурирайте това като Entity ID или Audience във вашия IdP

Този идентификатор гарантира, че SAML отговорите са предназначени за конкретния ви FastComments tenant и предотвратява приемането на SAML отговори от други екземпляри.

#### Assertion Consumer Service (ACS) URL
**Цел**: Крайна точка, където вашият IdP изпраща SAML отговорите след автентикация на потребителя  
**Формат**: `https://fastcomments.com/saml/callback/{your-tenant-id}`  
**Използване**: Конфигурирайте това като ACS URL или Reply URL във вашия IdP

Тук потребителите се пренасочват след успешна автентикация с вашия доставчик на идентичности, заедно със SAML асършъна, съдържаща информация за потребителя.

#### SP Metadata URL
**Цел**: Предоставя пълната SAML конфигурация в стандартен XML формат  
**Формат**: `https://fastcomments.com/saml/metadata/{your-tenant-id}`  
**Използване**: Някои IdP-та могат автоматично да импортират конфигурацията, като използват този URL

Metadata URL съдържа цялата необходима SP информация в XML формат, което улеснява автоматичната конфигурация на съвместими доставчици на идентичности.

#### SAML Login URL
**Цел**: Директен линк за иницииране на SAML автентикация за вашия tenant  
**Формат**: `https://fastcomments.com/saml/login/{your-tenant-id}`  
**Използване**: Свържете потребителите директно с SAML автентикацията или тествайте потока

Можете да използвате този URL, за да тествате SAML автентикацията или да предоставите на потребителите директен линк за влизане чрез SAML.

### Поддържани SAML биндинги

FastComments поддържа следните SAML биндинги:

#### HTTP-POST Binding
- **Основен метод**: Най-често срещаният биндинг за SAML отговори  
- **Сигурност**: SAML отговорът се изпраща чрез HTTP POST към ACS URL  
- **Използване**: Препоръчва се за продукционни внедрявания

#### HTTP-Redirect Binding
- **Алтернативен метод**: SAML отговорът се изпраща чрез HTTP redirect  
- **Ограничения**: Ограничен размер на полезния товар поради ограничения на дължината на URL-a  
- **Използване**: Поддържа се, но HTTP-POST е предпочитан

### Name ID политика

FastComments конфигурира следната Name ID политика в SAML заявките:

- **Дефолтен формат**: `urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress`  
- **Алтернативни формати**: Persistent, Transient, Unspecified (конфигурируеми)  
- **Изискване**: Имейл адресът се използва като основен идентификатор на потребителя

### Атрибути на SAML заявката

При иницииране на SAML автентикация, FastComments изпраща заявки с тези характеристики:

#### Подписване на заявки
- **Статус**: Незадължително (конфигурируемо)  
- **Алгоритъм**: Съответства на конфигурирания алгоритъм за подпис  
- **Сертификат**: Използва сертификат, специфичен за наемателя, ако подписването на заявки е активирано

#### Искани атрибути
FastComments иска следните атрибути в SAML AuthnRequests:

- **Email**: Required for user identification  
- **First Name**: Optional for display purposes  
- **Last Name**: Optional for display purposes  
- **Roles/Groups**: Optional for access control and permissions

### Копиране на SP информация

Страницата за SAML конфигурация предоставя кликваеми полета, които автоматично копират SP информацията в клипборда ви:

1. Кликнете върху всяко поле с SP информация (Entity ID, ACS URL и т.н.)  
2. Стойността автоматично се копира в клипборда ви  
3. Поставете стойността в конфигурацията на вашия доставчик на идентичности  
4. Кратко маркиране показва успешното копиране

Това улеснява точното прехвърляне на SP информацията към вашия IdP без грешки при писане.

### Информация за сертификата на SP

#### Използване на сертификата
- **Цел**: Шифрова комуникациите и потвърждава идентичността на SP  
- **Смяна**: Сертификатите се управляват автоматично от FastComments  
- **Достъп**: Публичните сертификати са достъпни чрез metadata URL

#### Подробности за сертификата
- **Алгоритъм**: RSA-2048 или по-висок  
- **Валидност**: Сертификатите се подновяват автоматично преди изтичане  
- **Разпространение**: Налични чрез стандартния SAML metadata

### Отстраняване на проблеми с конфигурацията на SP

Ако вашият доставчик на идентичности съобщава за проблеми с SP информацията:

1. **Проверете URL адресите**: Уверете се, че всички URL адреси използват HTTPS и съдържат правилния tenant ID  
2. **Проверете Metadata**: Използвайте metadata URL, за да проверите конфигурацията  
3. **Тествайте свързаността**: Уверете се, че вашият IdP може да достигне крайните точки на FastComments  
4. **Потвърдете формата**: Уверете се, че вашият IdP поддържа формата на SP информацията

Чести проблеми включват:
- Неправилен tenant ID в URL адресите  
- Проблеми с мрежовата свързаност между IdP и FastComments  
- IdP очаква различни формати на URL или допълнителни опции за конфигурация