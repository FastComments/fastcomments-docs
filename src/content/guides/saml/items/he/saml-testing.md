בדיקה של תצורת SAML שלך מוודאת שהאימות פועל כראוי לפני פריסה למשתמשי ייצור.

### רשימת בדיקה לפני הבדיקה

לפני בדיקת אימות SAML, ודא:

- ✅ SAML מופעל ב-FastComments
- ✅ כל השדות הדרושים מלאים (IdP URL, Certificate)
- ✅ ה-Identity provider מוגדר עם מידע ה-SP של FastComments
- ✅ חשבון משתמש מבחן קיים ב-IdP שלך
- ✅ למשתמש המבחן מוקצים התפקידים המתאימים

### שיטות בדיקה

#### שיטה 1: כתובת כניסה SAML ישירה

1. **קבל את כתובת הכניסה SAML**:
   - העתק מדף התצורה של SAML שלך
   - פורמט: `https://fastcomments.com/saml/login/{your-tenant-id}`

2. **בדוק את האימות**:
   - פתח את כתובת הכניסה של SAML בחלון דפדפן בסתר/פרטי
   - תועבר ל-identity provider שלך
   - היכנס עם אישורי המבחן
   - אמת את ההפניה המוצלחת חזרה ל-FastComments

#### שיטה 2: גישה ללוח הניהול

1. **נווט ל-FastComments**:
   - עבור אל [לוח הניהול של FastComments](https://fastcomments.com/auth/my-account)
   - חפש את אפשרות הכניסה באמצעות SAML או השתמש בכתובת הכניסה של SAML

2. **השלים את זרימת האימות**:
   - אמת דרך ה-identity provider שלך
   - אמת גישה לתכונות הניהול המתאימות בהתאם לתפקידים שהוקצו

#### שיטה 3: בדיקת אינטגרציה עם הווידג'ט

לבדיקת SAML עם ווידג'טים של תגובות:

1. **הטמע את הווידג'ט**: השתמש בווידג'ט של FastComments בעמוד מבחן
2. **אימות**: לחץ על כניסה ובחר באפשרות SAML (אם זמינה)
3. **אימות**: אשר שהמשתמש מופיע כמאומת בווידג'ט

### מה לאמת במהלך הבדיקה

#### זרימת האימות

**הפניה מוצלחת**:
- המשתמש מועבר לדף ההתחברות של IdP
- דף ההתחברות של IdP נטען כהלכה
- לא מתרחשים שגיאות תעודה או SSL

**אימות ב-IdP**:
- המשתמש יכול להיכנס עם אישורי ה-IdP שלו
- אימות רב-שלבי עובד (אם הוגדר)
- אין שגיאות אימות מה-IdP

**חזרה ל-FastComments**:
- המשתמש מועבר חזרה ל-FastComments לאחר התחברות מוצלחת ב-IdP
- אין שגיאות אימות של טענת SAML
- המשתמש מקבל גישה לתכונות המתאימות ב-FastComments

#### מידע על המשתמש

**נתוני פרופיל בסיסיים**:
- כתובת האימייל מתקבלת כראוי
- שם פרטי ושם משפחה מופיעים אם סופקו
- פרופיל המשתמש נוצר או מעודכן

**הקצאת תפקידים**:
- תפקידים ניהוליים מוקצים כראוי
- המשתמש בעל גישה לתכונות ניהול צפויות
- ההרשאות תואמות את התפקידים שהוקצו

#### אימות תגובת SAML

**אימות תעודה**:
- חתימת תגובת SAML מאומתת בהצלחה
- אין שגיאות אימות תעודה ביומנים
- התגובה מתקבלת כאמיתית

**עיבוד מאפיינים**:
- המאפיינים הנדרשים (email) קיימים
- המאפיינים האופציונליים מעובדים כהלכה
- מאפייני תפקיד מפורשים ומוחלים כראוי

### בדיקת תרחישים שונים

#### זרימת משתמש סטנדרטית

1. **משתמש חדש**:
   - כניסת SAML בפעם הראשונה
   - יצירת חשבון
   - הקצאת הרשאות בסיסיות

2. **משתמש קיים**:
   - כניסה של משתמש חוזר
   - עדכוני פרופיל
   - שינויים בתפקיד

#### בדיקת גישת מנהל

1. **תפקידים ניהוליים**:
   - בדוק משתמשים עם התפקיד `fc-admin-admin`
   - אמת גישה ללוח הניהול
   - אשר יכולות ניהוליות

2. **תפקידים מיוחדים**:
   - בדוק גישת `fc-moderator` לתכונות המודרציה
   - בדוק גישת `fc-analytics-admin` לניתוחים
   - בדוק גישת `fc-billing-admin` לתכונות החיוב

#### תרחישי שגיאה

1. **תעודות לא תקפות**:
   - בדוק עם תעודות שפג תוקפן או שגויות
   - אמת טיפול שגיאות תקין

2. **מאפיינים חסרים**:
   - בדוק תגובות SAML ללא מאפיין ה-email הנדרש
   - אמת טיפול שגיאות תקין

3. **בעיות רשת**:
   - בדוק עם בעיות קישוריות
   - אמת טיפול בזמן המתנה

### פתרון בעיות בבדיקות

#### בעיות אימות נפוצות

**לולאת הפניה**:
- בדוק ש-SP Entity ID תואם לתצורת ה-IdP
- אמת שכתובת ה-ACS (ACS URL) מוגדרת נכון
- אשר שהגדרות SAML binding תואמות

**שגיאות תעודה**:
- וודא שהתעודה כוללת את סימני BEGIN/END
- אמת שהתעודה לא פגה תוקף
- בדוק רווחים מיותרים או בעיות עיצוב

**בעיות מאפיינים**:
- אשר שמאפיין ה-email נשלח
- אמת שמאפייני התפקיד משתמשים בשם נכון
- בדוק את פורמט המאפיין (array לעומת מופרד בפסיקים)

#### כלי דיבוג

**כלי המפתחים בדפדפן**:
- נטר בקשות רשת במהלך זרימת SAML
- בדוק שגיאות HTTP או הפניות
- בדוק את נתוני POST של SAML (אם גלויים)

**כלי בדיקה של IdP**:
- רוב ה-IdP מספקים ממשקי בדיקה ל-SAML
- השתמש בכלי ה-IdP כדי לאמת את פורמט תגובת SAML
- בדוק את קונפיגורציית המאפיינים לפני שליחה ל-FastComments

**תמיכת FastComments**:
- הפעל רישום דיבוג במהלך הבדיקה
- שמור הודעות שגיאה וחותמות זמן
- פנה לתמיכה עם פרטי שגיאה ספציפיים

### שיטות מומלצות לבדיקות

#### הגדרת סביבות בדיקה

1. **משתמשי מבחן ייעודיים**:
   - צור חשבונות מבחן ספציפיים ב-IdP שלך
   - הקצה שילובי תפקידים שונים
   - השתמש בכתובות דוא"ל של מבחן שקל לזהות

2. **בדיקות מבודדות**:
   - השתמש בחלונות דפדפן בסתר/פרטיים
   - נקה עוגיות בין בדיקות
   - בדוק עם חשבונות משתמש שונים

3. **תיעוד**:
   - רישום תרחישי בדיקה ותוצאותיהם
   - תעד כל שינוי תצורה שנדרש
   - ציין פרטי קונפיגורציה מוצלחים

#### אימות לפני פריסה

1. **בדיקות מקיפות**:
   - בדוק את כל שילובי התפקידים
   - אמת מקרים קצה ותנאי שגיאה
   - אשר שהביצועים מקובלים

2. **קבלת משתמשים**:
   - תן למשתמשי קצה לבדוק את זרימת האימות
   - אסוף משוב על חוויית המשתמש
   - אמת שהזרימה עונה על הדרישות

3. **סקירת אבטחה**:
   - אשר שאימות התעודה עובד
   - אמת שהקצאות התפקידים בטוחות
   - בדוק אכיפת בקרת הגישה

### פריסה לייצור

לאחר בדיקות מוצלחות:

1. **פריסה הדרגתית**: שקול לפרוס את SAML תחילה לחלק מהמשתמשים
2. **ניטור**: נטר את שיעורי ההצלחה של האימות ואת יומני השגיאות
3. **הכנת תמיכה**: הכין את צוות התמיכה לשאלות הקשורות ל-SAML
4. **תיעוד**: ספק תיעוד למשתמש עבור תהליך הכניסה ב-SAML