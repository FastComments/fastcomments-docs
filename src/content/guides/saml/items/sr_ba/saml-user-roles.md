---
FastComments мапира SAML корисничке улоге на унутрашња овлашћења, омогућавајући контролу приступа засновану на улогама за вашу организацију.

### FastComments систем улога

FastComments користи систем дозвола заснован на улогама у коме корисници могу имати једну или више улога које одређују њихов ниво приступа и способности.

### Доступне FastComments улоге

#### Административне улоге

**fc-account-owner**
- **Овлашћења**: Потпуни административни приступ
- **Могућности**: Све функције, управљање наплатом, управљање корисницима
- **Примјер употребе**: Главни администратори налога и власници

**fc-admin-admin**  
- **Овлашћења**: Административни приступ већини функција
- **Могућности**: Управљање корисницима, конфигурација, модерација. **Може управљати другим администраторима.**
- **Примјер употребе**: Секундарни администратори и ИТ особље

**fc-billing-admin**
- **Овлашћења**: Управљање наплатом и претплатама
- **Могућности**: Начини плаћања, рачуни, промјене претплате
- **Примјер употребе**: Чланови финансијског тима и контакти за наплату

#### Специјализоване улоге

**fc-analytics-admin**
- **Овлашћења**: Приступ аналитици и извјештавању
- **Могућности**: Преглед статистике сајта, подаци о ангажману корисника
- **Примјер употребе**: Маркетиншки тимови и аналитичари података

**fc-api-admin**
- **Овлашћења**: Приступ API-ју и управљање
- **Могућности**: API креденцијали, конфигурација webhook-ова
- **Примјер употребе**: Развојни програмери и технички интегратори

**fc-moderator**
- **Овлашћења**: Могућности модерације коментара
- **Могућности**: Одобравање/одбијање коментара, управљање спамом
- **Примјер употребе**: Модератори заједнице и менаџери садржаја

### Конфигурација мапирања улога

#### Извори SAML атрибута

FastComments прихвата информације о улогама из различитих имена SAML атрибута како би се осигурала компатибилност са различитим провајдерима идентитета:

**Стандардна имена атрибута**:
- `roles`
- `groups` 
- `memberOf`
- `role`
- `group`

**Microsoft/ADFS атрибути**:
- `http://schemas.microsoft.com/ws/2008/06/identity/claims/role`
- `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/role`

#### Подржани формати улога

**Формат низа** *(Препоручено)*:
```xml
<saml:Attribute Name="roles">
    <saml:AttributeValue>fc-admin-admin</saml:AttributeValue>
    <saml:AttributeValue>fc-moderator</saml:AttributeValue>
</saml:Attribute>
```

**Формат одвојен зарезом**:
```xml
<saml:Attribute Name="roles">
    <saml:AttributeValue>fc-admin-admin,fc-moderator</saml:AttributeValue>
</saml:Attribute>
```

**Формат једне улоге**:
```xml
<saml:Attribute Name="roles">
    <saml:AttributeValue>fc-admin-admin</saml:AttributeValue>
</saml:Attribute>
```

### Конфигурација улога провајдера идентитета

#### Microsoft Azure AD

1. **Конфигурација улога апликације**:
   - Дефинишите FastComments улоге у вашој Azure AD апликацији
   - Додијелите кориснике одговарајућим улогама апликације
   - Конфигуришите тврђења (claims) да укључују додјељене улоге

2. **Мапирање атрибута**:
   ```
   Attribute Name: roles
   Source Attribute: user.assignedroles
   ```

#### Okta

1. **Додјела група**:
   - Креирајте групе које одговарају именима улога FastComments
   - Додијелите кориснике одговарајућим групама
   - Конфигуришите изјаве атрибута

2. **Изјава атрибута**:
   ```
   Name: roles
   Value: user.groups
   Filter: Starts with "fc-"
   ```

#### Google Workspace

1. **Мапирање група**:
   - Креирајте организационе јединице или групе
   - Назовите групе са префиксима улога FastComments
   - Конфигуришите мапирање атрибута

2. **Прилагођени атрибути**:
   ```
   Attribute Name: roles
   Value: Groups or custom schema attribute
   ```

### Подразумјевано понашање корисника

#### Корисници без улога

Када SAML корисник нема улоге или има непрепознате улоге:
- Корисник се креира као стандардни коментатор
- Административни приступ није додјељен
- Може објављивати и управљати својим коментарима
- Не може приступити функцијама административног панела

#### Насљедство улога

- Корисници могу истовремено имати више улога
- Овлашћења су кумулативна (примјењује се највиши ниво овлашћења)
- Промјене улога у IdP-у се одражавају при сљедећем пријављивању

### Управљање SAML корисницима

#### Креирање корисника

Када се корисник први пут пријави путем SAML-а:
1. **Кориснички налог**: Аутоматски креиран са е-поштом као идентификатор
2. **Додијела улога**: Улоге се примјењују на основу SAML атрибута
3. **Профилни подаци**: Име/презиме попуњени ако су достављени
4. **Активирање овлашћења**: Улоге постају активне одмах

#### Ажурирања улога

Постојећи SAML корисници примају ажурирања улога:
1. **Покретање при пријави**: Ажурирања улога се врше током сваког SAML пријављивања
2. **Одмаховни ефекат**: Нова овлашћења се примјењују одмах
3. **Уклањање улоге**: Уклоњене улоге се аутоматски поништавају
4. **Дневник ревизије**: Промјене улога се евидентирају у дневницима ревизије

### Прилагођено мапирање улога

#### Прилагођавање за предузећа

За корпоративне купце са специфичним захтјевима:
- Прилагођена имена улога могу бити мапирана на FastComments овлашћења
- Могу се имплементирати сложене хијерархије улога
- Могу се конфигурисати контроле приступа специфичне за одељења

Контактирајте FastComments подршку за конфигурације прилагођеног мапирања улога.

#### Валидација улога

FastComments провјерава улазне улоге:
- Непрепознате улоге се игноришу (не одбијају се)
- Неисправни атрибути улога се евидентирају за отклањање проблема
- Корисници задржавају постојеће улоге ако SAML изјава нема информације о улогама

### Најбоље праксе

#### Управљање улогама

1. **Принцип најмањих привилегија**: Додијелите минимално потребна овлашћења
2. **Редовна ревизија**: Периодично прегледајте улоге и приступе корисника  
3. **Јасно именовање**: Користите описна имена група у вашем IdP-у
4. **Документација**: Одржавајте документацију о додијелама улога

#### Безбједносни аспекти

1. **Атрибути улога**: Осигурајте да су атрибути улога правилно заштићени у SAML одговорима
2. **Валидација атрибута**: Потврдите да само овлашћени системи могу додјељивати улоге
3. **Прегледи приступа**: Редовно прегледавајте додијеле административних улога
4. **Мониторинг**: Пратите промјене улога и административне радње

### Ријешавање проблема са улогама

#### Чести проблеми

**Улоге нису примјењене**:
- Провјерите да имена SAML атрибута одговарају подржаним форматима
- Потврдите да IdP шаље информације о улогама
- Потврдите да вриједности улога тачно одговарају именима улога FastComments

**Приступ одбијен**:
- Потврдите да је кориснику у IdP-у додјељена одговарајућа улога
- Провјерите правопис улоге и осјетљивост на велика/мала слова
- Потврдите да је улога правилно форматирана у SAML одговору

**Недостајућа овлашћења**:
- Прегледајте дефиниције улога и потребна овлашћења
- Провјерите има ли сукобљених додијела улога
- Потврдите да се корисник пријавио након промјена улога

---