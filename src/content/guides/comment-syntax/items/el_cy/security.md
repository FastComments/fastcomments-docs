Υπάρχουν πολλαπλές πτυχές ασφάλειας όταν επιτρέπουμε στους ανθρώπους να προσθέτουν περιεχόμενο σε έναν ιστότοπο και στη συνέχεια να αποδίδουμε αυτό το περιεχόμενο σε πολλούς διαφορετικούς τύπους συσκευών.

### Αποτροπή κατάχρησης μορφοποίησης

Οι άνθρωποι μπορούν να γράψουν περιεχόμενο που είναι σκόπιμα οπτικά αποσπαστικό και μειώνει την αξία των συζητήσεων καταχρώμενοι τη μορφοποίηση κειμένου.

Το FastComments κάνει διάφορα πράγματα για να αποτρέψει την κατάχρηση σε σχέση με τη μορφοποίηση:

- Οι μεγάλες επαναλαμβανόμενες διαδοχικές αλλαγές γραμμής συμπτύσσονται.
- Δεν αποδίδουμε επικεφαλίδες (γίνονται κανονικό κείμενο).
- Δεν επιτρέπουμε CSS ή προσαρμοσμένα χρώματα.

### Αποτροπή exploits

Τα exploits μπορούν να δημιουργηθούν σε συστήματα που αποδίδουν HTML. Το FastComments κάνει διάφορα πράγματα για να το αποτρέψει αυτό:

- Επιτρέπουμε μόνο ένα ρητά καθορισμένο σύνολο ετικετών HTML.
- Επιτρέπουμε μόνο ένα ρητά καθορισμένο σύνολο χαρακτηριστικών ετικετών HTML.
- Καθαρίζουμε και απολυμαίνουμε όλες τις εισόδους.
  - Αυτό γίνεται μέσω των βιβλιοθηκών [DOMPurify](https://www.npmjs.com/package/dompurify) και [sanitizeHtml](https://www.npmjs.com/package/sanitize-html).
  - Επιλέξαμε αυτές τις βιβλιοθήκες επειδή είναι καλά δοκιμασμένες (με πάνω από 4 και 1 εκατομμύριο λήψεις την εβδομάδα, αντίστοιχα).

Αυτό σημαίνει ότι οι χρήστες δεν μπορούν να κάνουν πράγματα όπως να γράψουν ετικέτες `<script>` ή `<style>`, ή να προσπαθήσουν να προσθέσουν scripts τύπου `onload=alert()` σε εικόνες ή άλλο περιεχόμενο.

Οι ετικέτες HTML που επιτρέπουμε είναι οι εξής:

- `<b>`
- `<em>`
- `<u>`
- `<i>`
- `<strike>`
- `<pre>`
- `<span>`
- `<code>`
- `<img>`
- `<a>`
- `<strong>`
- `<ul>`
- `<ol>`
- `<li>`
- `<br>`
