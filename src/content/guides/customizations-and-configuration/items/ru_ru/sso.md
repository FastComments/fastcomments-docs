SSO, или single-sign-on, — это набор соглашений, позволяющих вам или вашим пользователям пользоваться FastComments без необходимости создавать ещё одну учётную запись.

Если вы не разрешаете анонимные комментарии, для комментирования через FastComments требуется учётная запись. Мы делаем процесс регистрации очень простым — пользователь просто оставляет свой email при комментарии.
Тем не менее, мы понимаем, что даже это может быть лишним трением, от которого некоторые сайты хотят избавиться.

Мы можем снизить это трение, оставив только один поток входа для всего вашего сайта.

### How do I get it?
Все типы аккаунтов в настоящий момент получают доступ к SSO. Однако максимальное количество SSO-пользователей будет варьироваться в зависимости от вашего пакета. Как и с другими функциями, планы Pro и выше предоставляют прямую поддержку разработки.

Давайте сравним варианты, а затем перейдём к подробностям каждого.

### User and Comment Migrations

При миграции с платформы с SSO, такой как Disqus, у вас уже будут пользователи и их комментарии.

Комментарии импортируются как часть вашей миграции — либо через API, через наш Import UI, либо службой поддержки. Предпочтительнее использовать Import UI, если он поддерживает платформу, с которой вы мигрируете, поскольку он включает обработку ошибок, извлечение и загрузку аватаров и медиа, а также систему мониторинга пакетных заданий.

Сами пользователи добавляются автоматически при первом просмотре веток комментариев. Альтернативно, их можно предварительно добавить через API, но это не даёт многих преимуществ.

Если комментарии импортируются, а SSO-пользователи не добавляются вручную через API, то комментарии автоматически будут сопоставлены с учётной записью пользователя при первом создании этой учётной записи, когда пользователь просматривает любую ветку комментариев. После этого они смогут управлять, редактировать и удалять ранее написанные ими комментарии.

Автоматическая миграция выполняется по email или имени пользователя. Некоторые платформы не предоставляют email при экспорте, как Disqus, поэтому в этом случае мы используем имя пользователя.
- Пока вы передаёте совпадающее имя пользователя и email в SSO-полезной нагрузке, мы добавим email к объектам отдельных комментариев, чтобы уведомления и упоминания работали.

Если вы хотите импортировать ваши комментарии и пользователей одновременно, свяжитесь с поддержкой, чтобы перенести комментарии в соответствующие учётные записи пользователей после импорта пользователей через API.

Итак, чтобы суммировать самый простой путь миграции:

1. Импортируйте комментарии.
   1. Аватары и другие медиа мигрируются автоматически при использовании Import UI в `Manage Data -> Imports`.
2. Настройте Secure или Simple SSO.
3. Позвольте миграции происходить автоматически для каждого пользователя при их первом входе.
   1. Обычно это добавляет меньше секунды к времени загрузки страницы, если у пользователя менее 50k комментариев.

### WordPress Users
Если вы используете наш <a href="https://wordpress.org/plugins/fastcomments/" target="_blank">плагин WordPress</a>, то код писать не нужно! Просто перейдите на страницу администрирования плагина, нажмите SSO Settings, а затем Enable.

Это приведёт вас к мастеру с одной кнопкой, который создаст ваш API-ключ, отправит его на ваш WordPress и включит SSO. Мы объединили это в одно нажатие кнопки для вашего удобства.

Обратите внимание, что если вы устанавливаете плагин впервые, вам потребуется пройти процесс настройки, прежде чем вы увидите страницу администрирования с кнопкой SSO Settings.

#### WordPress SSO - Moderators

Обратите внимание, что в настоящее время, чтобы рядом с вашими модераторами при их комментарии через FastComments WordPress plugin отображалась бейдж «Moderator»,
они также должны быть добавлены как Moderator в панели управления FastComments и иметь подтверждённый email.

### Custom Integrations

Для кастомных интеграций есть два варианта.

### Option One - Secure SSO

С Secure SSO FastComments знает, что пользователь, комментирующий, голосующий и читающий комментарии, является реальным пользователем вашего сайта.

Пока вы создаёте корректную полезную нагрузку, пользователь всегда будет иметь бесшовный опыт комментирования.

С Secure SSO полезная нагрузка SSO создаётся на стороне сервера с использованием HMAC-аутентификации и затем передаётся виджету на клиенте.

С Secure SSO учётная запись пользователя полностью отделена от остальной базы пользователей FastComments. Это означает, что если у нас есть два партнёра — Company A и Company B, — у каждого может быть SSO-пользователь с именем пользователя "Bob".

#### Requirements
- Базовые знания разработки backend.
- Базовые знания работы с секретными API-ключами.
- Базовые знания разработки API или серверного рендеринга.

#### Pros
- Безопасно.
- Бесшовный опыт комментирования.

#### Cons
- Требуется разработка на стороне сервера.

#### Updating User Data

С Secure SSO каждый раз, когда вы передаёте SSO-полезную нагрузку пользователя, мы обновляем их профиль с последней информацией. Например, если
у пользователя было имя пользователя `X`, и вы передаёте `Y` в SSO-полезной нагрузке, их имя пользователя станет `Y`.

Если вы хотите удалить значения с помощью этого подхода, установите их в `null` (не `undefined`).

#### Secure SSO API

Мы также предоставляем API для взаимодействия с SSO-пользователями. Смотрите [the docs](/guide-api.html#sso-user-structure).

Обратите внимание, что при использовании Secure SSO пользователи автоматически создаются в фоновом режиме при загрузке страницы. Вам не нужно массово импортировать ваших пользователей.

### Option Two - Simple SSO

Альтернатива Secure SSO — просто передавать информацию о пользователе виджету комментариев.

Предоставление email при Simple SSO не обязательно, однако без него их комментарии будут отображаться как "Unverified".

<sup>Note!</sup> Начиная с начала 2022 года имена пользователей при Simple SSO не обязаны быть уникальными по всему FastComments.com.

Идеально, если Simple SSO выбирается только при разработке на платформе, где нет доступа к backend.

#### Requirements
- Базовые знания клиентской разработки.
- Необходимо знать по крайней мере email пользователя.

#### Pros
- Просто.
- Вся активность всё ещё проходит проверку.
- Пользователь никогда не вводит своё имя пользователя или email.

#### Cons
- Менее безопасно, чем Secure SSO, так как полезная нагрузка на стороне клиента может быть подделана, чтобы притвориться любым пользователем.

#### Simple SSO API

Пользователи, автоматически создаваемые через поток Simple SSO, сохраняются как объекты `SSOUser`. К ним можно получить доступ и управлять ими через API `SSOUser`. Смотрите [the docs](/guide-api.html#sso-user-structure).